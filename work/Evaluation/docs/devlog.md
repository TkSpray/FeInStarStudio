# Kase前端开发日志

因为我第一次写这么大的工程，为了方便记录以及梳理下逻辑，所以就有了这么个日志。

## 前端路由

因为是Vue框架，所以前端路由就用vue-router了。

在确定路由之前，首先应该确定的是需要什么界面。首先应该分为三个用户，申请者、评审员和管理员，目前的登录逻辑是三类用户全部用一个接口登录，由后端确定用户类型，然后在token中用`type`来告诉前端是什么类型的用户。因为所有页面都在`App.vue`下，所以使用这个文件来完成一些统一操作。

### 登录页面

登录页面是统一的，所有用户类型都是同一个。考虑到前端不能存数据，以及cookie跨域会获取不到的问题，对用户登录的情况用一个状态来保存。不过有个问题就是页面刷新之后vuex中的状态会丢失，需要解决持久化问题，但是基于浏览器存储的话多少感觉不太可靠，另外还有服务器数据同步问题。为了同时搞定这两个，我的想法是在建立vuex的时候向服务器拉取数据，这个可以用`App.vue`的`created`钩子完成，拉取到的话就把`logined`状态设为`ture`，否则`false`。在路由导航中判断`logined`状态，对于一切`logined=false`的情况都导航到`/login`。

### 申请人页面

#### 主面板

申请人界面其实比较简单，主面板是申请课题列表，点击进去后可以看到课题的详细情况，可以在线预览文档和附件。主页面就不需要特殊什么的了，直接就是根目录就行。详细情况、文档、附件可以作为三块页面。

#### 侧面板

侧面板的话，感觉固定内容就行。新建课题、查看通知、查看标准、重设密码、登出。以弹出对话框的方式工作。

### 审核人页面

#### 主面板

主面板的话是需要评审的课题，其实也是列表。点击之后进入评审，此时侧面板会自动变成分数框。当然也是分三块页面，详细情况，文档和附件，页面路由基本同申请人。只是在不是主面板的情况下侧面板需要变化而已。

#### 侧面板

侧面板有两种状态，在根目录下是功能区，在评审下用来打分。

### 管理员页面

管理员页面会稍微复杂一些。

#### 主面板

和上面两个不同，主面板首先显示的是项目列表。点进去之后才是课题列表，同时侧面板会变为对应的内容，可以进行评审账号生成和分配等等，也可以进行课题分配，课题分区等等。

#### 侧面板

随主面板变化而变动就行，进行常规操作。

## 页面架构

### 状态

使用vuex管理状态。状态包括

- logined 登录状态
- inited 是否初始化
- username 用户名，用来在页面上显示
- type 用户类型，0.未确定，1.申请人，2.审核人，3.管理员
- jumpedURL 登录之后跳转
- loginMsg 登录面板的提示
- projectList 项目列表

### 页面路由

页面路由全部统一，如下

- `/` 主面板，课题列表
- `/subject/<cid>/detail` 课题详细情况
- `/subject/<cid>/article` 课题文档预览
- `/subject/<cid>/file` 课题附件预览